<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AgriConnect - Supply Chain Management</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='portal.css') }}">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/marked@4.0.2/marked.min.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                        secondary: '#4F4FC7',
                        dark: {
                            bg: '#181818',
                            card: '#252525',
                            text: '#E5E5E5'
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="min-h-screen bg-gray-50 text-gray-900 dark:bg-dark-bg dark:text-dark-text transition-colors duration-200">
    <div class="min-h-screen flex flex-col">
        <!-- Header -->
        <header class="bg-white dark:bg-dark-card shadow-sm">
            <div class="container mx-auto px-4 py-3 flex justify-between items-center">
                <div class="flex items-center space-x-2">
                    <i class="fas fa-leaf text-2xl text-green-500 mr-2"></i>
                    <h1 class="text-xl md:text-2xl font-bold">AgriConnect</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <button id="notificationBtn" class="relative p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
                        </svg>
                        <span id="notificationBadge" class="hidden badge-animate absolute top-0 right-0 bg-red-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center">0</span>
                    </button>
                    <div class="relative">
                        <button id="userMenuBtn" class="flex items-center focus:outline-none">
                            <div class="w-8 h-8 rounded-full bg-primary text-white flex items-center justify-center">
                                <span id="userInitials">JS</span>
                            </div>
                        </button>
                        <div id="userMenu" class="hidden absolute right-0 mt-2 w-48 bg-white dark:bg-dark-card rounded-md shadow-lg z-10">
                            <div class="py-1">
                                <button id="switchUserBtn" class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">Switch User Type</button>
                                <button id="toggleDarkMode" class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">Toggle Dark Mode</button>
                                <button class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">Settings</button>
                                <button class="w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <a href="{{ url_for('logout') }}"> Logout </a>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="flex-grow container mx-auto px-4 py-6">
            <!-- Dashboard -->
            <div class="flex flex-col md:flex-row gap-6">
                <!-- Sidebar Navigation -->
                <div class="w-full md:w-1/4 lg:w-1/5">
                    <div class="bg-white dark:bg-dark-card rounded-lg shadow-sm p-4">
                        <nav>
                            <ul class="space-y-1">
                                <li>
                                    <button data-view="dashboard" class="nav-btn w-full flex items-center space-x-2 p-2 rounded-md text-left bg-primary bg-opacity-10 text-primary">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                                        </svg>
                                        <span>Dashboard</span>
                                    </button>
                                </li>
                                <li>
                                    <button data-view="orders" class="nav-btn w-full flex items-center space-x-2 p-2 rounded-md text-left hover:bg-gray-100 dark:hover:bg-gray-700">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
                                        </svg>
                                        <span>Orders</span>
                                    </button>
                                </li>
                                <li>
                                    <button data-view="inventory" class="nav-btn w-full flex items-center space-x-2 p-2 rounded-md text-left hover:bg-gray-100 dark:hover:bg-gray-700">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" />
                                        </svg>
                                        <span>Inventory</span>
                                    </button>
                                </li>
                                <li>
                                    <button data-view="tracking" class="nav-btn w-full flex items-center space-x-2 p-2 rounded-md text-left hover:bg-gray-100 dark:hover:bg-gray-700">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                                        </svg>
                                        <span>Delivery Tracking</span>
                                    </button>
                                </li>
                                <li>
                                    <button data-view="analytics" class="nav-btn w-full flex items-center space-x-2 p-2 rounded-md text-left hover:bg-gray-100 dark:hover:bg-gray-700">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                                        </svg>
                                        <span>Analytics</span>
                                    </button>
                                </li>
                            </ul>
                        </nav>
                    </div>
                </div>

                <!-- Main Content Area -->
                <div class="w-full md:w-3/4 lg:w-4/5">
                    <!-- Dashboard View -->
                    <div id="dashboard-view" class="view-content">
                        <div class="flex flex-col space-y-6">
                            <!-- Welcome Card -->
                            <div class="bg-white dark:bg-dark-card rounded-lg shadow-sm p-6">
                                <div class="flex items-start justify-between">
                                    <div>
                                        <h2 class="text-xl font-bold mb-2">Welcome, <span id="userName">{{  current_user.username }}</span>!</h2>
                                        <p class="text-gray-600 dark:text-gray-400" id="userRole">You are logged in as a Farmer.</p>
                                        <p class="mt-4">Farmer Details:</p>
                                        <ul class="mt-2 list-disc list-inside text-gray-600 dark:text-gray-400">
                                            <li>Name <span id="pendingOrdersCount" class="font-medium text-primary">John Smith</span></li>
                                            <li>Farm Name:<span id="inTransitOrdersCount" class="font-medium text-primary">Smith Family Farm</span></li>
                                            <li><span id="completedOrdersCount" class="font-medium text-primary">8</span> orders completed this month</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <h2 class="text-xl font-bold mb-2">Welcome, <span id="userName">{{  current_user.username }}</span>!</h2>
                                        <p class="text-gray-600 dark:text-gray-400" id="userRole">You are logged in as a Farmer.</p>
                                        <p class="mt-4">Quick Summary:</p>
                                        <ul class="mt-2 list-disc list-inside text-gray-600 dark:text-gray-400">
                                            <li>You have <span id="pendingOrdersCount" class="font-medium text-primary">3</span> pending orders</li>
                                            <li><span id="inTransitOrdersCount" class="font-medium text-primary">2</span> orders are in transit</li>
                                            <li><span id="completedOrdersCount" class="font-medium text-primary">8</span> orders completed this month</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <h2 class="text-xl font-bold mb-2">Welcome, <span id="userName">{{  current_user.username }}</span>!</h2>
                                        <p class="text-gray-600 dark:text-gray-400" id="userRole">You are logged in as a Farmer.</p>
                                        <p class="mt-4">Quick Summary:</p>
                                        <ul class="mt-2 list-disc list-inside text-gray-600 dark:text-gray-400">
                                            <li>You have <span id="pendingOrdersCount" class="font-medium text-primary">3</span> pending orders</li>
                                            <li><span id="inTransitOrdersCount" class="font-medium text-primary">2</span> orders are in transit</li>
                                            <li><span id="completedOrdersCount" class="font-medium text-primary">8</span> orders completed this month</li>
                                        </ul>
                                    </div>
                                    <div class="hidden sm:block">
                                        <div class="w-20 h-20 bg-primary bg-opacity-10 rounded-full flex items-center justify-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h.5A2.5 2.5 0 0020 5.5v-1.5" />
                                            </svg>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Quick Actions -->
                            <div class="bg-white dark:bg-dark-card rounded-lg shadow-sm p-6">
                                <h3 class="text-lg font-semibold mb-4">Quick Actions</h3>
                                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
                                    <button id="placeOrderBtn" class="farmer-only flex flex-col items-center justify-center p-4 bg-primary bg-opacity-10 rounded-lg hover:bg-opacity-20 transition-colors">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z" />
                                        </svg>
                                        <span class="mt-2 text-sm font-medium">Place New Order</span>
                                    </button>
                                    <button id="manageInventoryBtn" class="supplier-only flex flex-col items-center justify-center p-4 bg-green-100 dark:bg-green-900 dark:bg-opacity-20 rounded-lg hover:bg-green-200 dark:hover:bg-green-800 dark:hover:bg-opacity-30 transition-colors">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-green-600 dark:text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" />
                                        </svg>
                                        <span class="mt-2 text-sm font-medium">Manage Inventory</span>
                                    </button>
                                    <button id="trackOrderBtn" class="flex flex-col items-center justify-center p-4 bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-800 dark:hover:bg-opacity-30 transition-colors">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-blue-600 dark:text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                                        </svg>
                                        <span class="mt-2 text-sm font-medium">Track Orders</span>
                                    </button>
                                </div>
                            </div>

                            <!-- Recent Activity -->
                            <div class="bg-white dark:bg-dark-card rounded-lg shadow-sm p-6">
                                <h3 class="text-lg font-semibold mb-4">Recent Activity</h3>
                                <div class="overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead>
                                            <tr>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Date</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Activity</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
                                            </tr>
                                        </thead>
                                        <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="recentActivityTable">
                                            <!-- Activities will be loaded here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Orders View -->
                    <div id="orders-view" class="view-content hidden">
                        <div class="flex flex-col space-y-6">
                            <div class="bg-white dark:bg-dark-card rounded-lg shadow-sm p-6">
                                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6">
                                    <h2 class="text-xl font-bold">Manage Orders</h2>
                                    <button id="newOrderBtn" class="farmer-only mt-4 sm:mt-0 px-4 py-2 bg-primary text-white rounded-md hover:bg-secondary transition-colors">
                                        <div class="flex items-center space-x-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                                            </svg>
                                            <span>New Order</span>
                                        </div>
                                    </button>
                                </div>
                                
                                <!-- Filter Controls -->
                                <div class="mb-6 flex flex-col sm:flex-row gap-4">
                                    <div class="flex-1">
                                        <label for="orderStatusFilter" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                                        <select id="orderStatusFilter" class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-dark-bg text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary">
                                            <option value="all">All</option>
                                            <option value="pending">Pending</option>
                                            <option value="approved">Approved</option>
                                            <option value="in-transit">In Transit</option>
                                            <option value="delivered">Delivered</option>
                                            <option value="cancelled">Cancelled</option>
                                        </select>
                                    </div>
                                    <div class="flex-1">
                                        <label for="orderDateFilter" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Order Date</label>
                                        <select id="orderDateFilter" class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-dark-bg text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary">
                                            <option value="all">All Time</option>
                                            <option value="today">Today</option>
                                            <option value="week">This Week</option>
                                            <option value="month">This Month</option>
                                            <option value="quarter">Last 3 Months</option>
                                        </select>
                                    </div>
                                    <div class="flex-1">
                                        <label for="orderSearch" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Search</label>
                                        <input type="text" id="orderSearch" placeholder="Search orders..." class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-dark-bg text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary">
                                    </div>
                                </div>
                                
                                <!-- Orders Table -->
                                <div class="overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead>
                                            <tr>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Order ID</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider supplier-only">Farmer</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider farmer-only">Supplier</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Date</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Items</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Total</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="ordersTableBody">
                                            <!-- Orders will be loaded here -->
                                        </tbody>
                                    </table>
                                </div>
                                <div id="ordersTableEmpty" class="text-center py-8 hidden">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" />
                                    </svg>
                                    <p class="mt-2 text-gray-500 dark:text-gray-400">No orders found</p>
                                    <button class="farmer-only mt-4 px-4 py-2 bg-primary text-white rounded-md hover:bg-secondary transition-colors">Place Your First Order</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Inventory View -->
                    <div id="inventory-view" class="view-content hidden">
                        <div class="flex flex-col space-y-6">
                            <div class="bg-white dark:bg-dark-card rounded-lg shadow-sm p-6">
                                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6">
                                    <h2 class="text-xl font-bold">Inventory Management</h2>
                                    <button id="addProductBtn" class="supplier-only mt-4 sm:mt-0 px-4 py-2 bg-primary text-white rounded-md hover:bg-secondary transition-colors">
                                        <div class="flex items-center space-x-2">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                                            </svg>
                                            <span>Add Product</span>
                                        </div>
                                    </button>
                                </div>
                                
                                <!-- Filter Controls -->
                                <div class="mb-6 flex flex-col sm:flex-row gap-4">
                                    <div class="flex-1">
                                        <label for="categoryFilter" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Category</label>
                                        <select id="categoryFilter" class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-dark-bg text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary">
                                            <option value="all">All Categories</option>
                                            <option value="seeds">Seeds</option>
                                            <option value="fertilizers">Fertilizers</option>
                                            <option value="pesticides">Pesticides</option>
                                            <option value="equipment">Equipment</option>
                                        </select>
                                    </div>
                                    <div class="flex-1">
                                        <label for="stockFilter" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Stock Status</label>
                                        <select id="stockFilter" class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-dark-bg text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary">
                                            <option value="all">All</option>
                                            <option value="in-stock">In Stock</option>
                                            <option value="low-stock">Low Stock</option>
                                            <option value="out-of-stock">Out of Stock</option>
                                        </select>
                                    </div>
                                    <div class="flex-1">
                                        <label for="inventorySearch" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Search</label>
                                        <input type="text" id="inventorySearch" placeholder="Search products..." class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-dark-bg text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary">
                                    </div>
                                </div>
                                
                                <!-- Products Grid -->
                                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6" id="productsGrid">
                                    <!-- Products will be loaded here -->
                                </div>
                                <div id="productsGridEmpty" class="text-center py-8 hidden">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" />
                                    </svg>
                                    <p class="mt-2 text-gray-500 dark:text-gray-400">No products found</p>
                                    <button class="supplier-only mt-4 px-4 py-2 bg-primary text-white rounded-md hover:bg-secondary transition-colors">Add Your First Product</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tracking View -->
                    <div id="tracking-view" class="view-content hidden">
                        <div class="flex flex-col space-y-6">
                            <div class="bg-white dark:bg-dark-card rounded-lg shadow-sm p-6">
                                <h2 class="text-xl font-bold mb-6">Delivery Tracking</h2>
                                
                                <!-- Search Order for Tracking -->
                                <div class="mb-6">
                                    <label for="trackingOrderSearch" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Enter Order ID to Track</label>
                                    <div class="flex">
                                        <input type="text" id="trackingOrderSearch" placeholder="e.g., ORD-12345" class="flex-1 border border-gray-300 dark:border-gray-600 rounded-l-md px-3 py-2 bg-white dark:bg-dark-bg text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary text-base">
                                        <button id="trackOrderSearchBtn" class="px-4 py-2 bg-primary text-white rounded-r-md hover:bg-secondary transition-colors">
                                            Track
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Tracking Result -->
                                <div id="trackingResult" class="hidden">
                                    <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4 mb-6">
                                        <div class="flex flex-col sm:flex-row justify-between mb-4">
                                            <div>
                                                <h3 class="text-lg font-semibold" id="trackingOrderId">Order #ORD-12345</h3>
                                                <p class="text-sm text-gray-600 dark:text-gray-400" id="trackingOrderDate">Ordered on: May 15, 2023</p>
                                            </div>
                                            <div class="mt-2 sm:mt-0">
                                                <span id="trackingOrderStatus" class="inline-block px-3 py-1 text-sm rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-30 dark:text-yellow-300">In Transit</span>
                                            </div>
                                        </div>
                                        
                                        <!-- Order Info -->
                                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                                            <div>
                                                <h4 class="text-sm font-medium text-gray-500 dark:text-gray-400">From</h4>
                                                <p class="mt-1" id="trackingSupplier">AgriSupply Inc.</p>
                                            </div>
                                            <div>
                                                <h4 class="text-sm font-medium text-gray-500 dark:text-gray-400">To</h4>
                                                <p class="mt-1" id="trackingFarmer">John Smith Farm</p>
                                            </div>
                                            <div>
                                                <h4 class="text-sm font-medium text-gray-500 dark:text-gray-400">Estimated Delivery</h4>
                                                <p class="mt-1" id="trackingETA">May 20, 2023</p>
                                            </div>
                                        </div>
                                        
                                        <!-- Tracking Timeline -->
                                        <div class="relative">
                                            <div class="absolute left-5 top-0 bottom-0 w-0.5 bg-gray-200 dark:bg-gray-700"></div>
                                            <div id="trackingTimeline">
                                                <!-- Timeline events will be loaded here -->
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Order Items Summary -->
                                    <h3 class="text-lg font-semibold mb-3">Order Items</h3>
                                    <div class="overflow-x-auto">
                                        <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                            <thead>
                                                <tr>
                                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Product</th>
                                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Quantity</th>
                                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Price</th>
                                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Total</th>
                                                </tr>
                                            </thead>
                                            <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="trackingItemsTable">
                                                <!-- Order items will be loaded here -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                
                                <!-- No Results State -->
                                <div id="trackingNoResult" class="text-center py-8 hidden">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                    <p class="mt-2 text-gray-500 dark:text-gray-400">No order found with that ID</p>
                                    <p class="text-sm text-gray-400 dark:text-gray-500">Please check the order ID and try again</p>
                                </div>
                                
                                <!-- Initial Empty State -->
                                <div id="trackingEmptyState" class="text-center py-8">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                                    </svg>
                                    <p class="mt-2 text-gray-500 dark:text-gray-400">Enter an order ID above to track a delivery</p>
                                </div>
                            </div>
                            
                            <!-- Recent Deliveries -->
                            <div class="bg-white dark:bg-dark-card rounded-lg shadow-sm p-6">
                                <h3 class="text-lg font-semibold mb-4">Recent Deliveries</h3>
                                <div class="overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead>
                                            <tr>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Order ID</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider supplier-only">Farmer</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider farmer-only">Supplier</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Updated</th>
                                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="recentDeliveriesTable">
                                            <!-- Recent deliveries will be loaded here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Analytics View -->
                    <div id="analytics-view" class="view-content hidden">
                        <div class="flex flex-col space-y-6">
                            <!-- Overview Stats -->
                            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                                <div class="bg-white dark:bg-dark-card rounded-lg shadow-sm p-6">
                                    <div class="flex justify-between items-start">
                                        <div>
                                            <p class="text-sm text-gray-500 dark:text-gray-400">Total Orders</p>
                                            <h3 class="text-2xl font-bold mt-1" id="statsOrdersTotal">154</h3>
                                            <p class="text-xs text-green-600 dark:text-green-400 mt-1">
                                                <span>↑ 12%</span>
                                                <span class="text-gray-500 dark:text-gray-400">vs last month</span>
                                            </p>
                                        </div>
                                        <div class="bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20 p-3 rounded-full">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600 dark:text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
                                            </svg>
                                        </div>
                                    </div>
                                </div>
                                <div class="bg-white dark:bg-dark-card rounded-lg shadow-sm p-6">
                                    <div class="flex justify-between items-start">
                                        <div>
                                            <p class="text-sm text-gray-500 dark:text-gray-400">Completed Deliveries</p>
                                            <h3 class="text-2xl font-bold mt-1" id="statsDeliveriesCompleted">132</h3>
                                            <p class="text-xs text-green-600 dark:text-green-400 mt-1">
                                                <span>↑ 8%</span>
                                                <span class="text-gray-500 dark:text-gray-400">vs last month</span>
                                            </p>
                                        </div>
                                        <div class="bg-green-100 dark:bg-green-900 dark:bg-opacity-20 p-3 rounded-full">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-600 dark:text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                            </svg>
                                        </div>
                                    </div>
                                </div>
                                <div class="bg-white dark:bg-dark-card rounded-lg shadow-sm p-6">
                                    <div class="flex justify-between items-start">
                                        <div>
                                            <p class="text-sm text-gray-500 dark:text-gray-400">Average Delivery Time</p>
                                            <h3 class="text-2xl font-bold mt-1" id="statsAvgDeliveryTime">3.8 days</h3>
                                            <p class="text-xs text-red-600 dark:text-red-400 mt-1">
                                                <span>↑ 0.5 days</span>
                                                <span class="text-gray-500 dark:text-gray-400">vs last month</span>
                                            </p>
                                        </div>
                                        <div class="bg-orange-100 dark:bg-orange-900 dark:bg-opacity-20 p-3 rounded-full">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-orange-600 dark:text-orange-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                            </svg>
                                        </div>
                                    </div>
                                </div>
                                <div class="bg-white dark:bg-dark-card rounded-lg shadow-sm p-6">
                                    <div class="flex justify-between items-start">
                                        <div>
                                            <p class="text-sm text-gray-500 dark:text-gray-400">Total Value</p>
                                            <h3 class="text-2xl font-bold mt-1" id="statsTotalValue">$28,745</h3>
                                            <p class="text-xs text-green-600 dark:text-green-400 mt-1">
                                                <span>↑ 15%</span>
                                                <span class="text-gray-500 dark:text-gray-400">vs last month</span>
                                            </p>
                                        </div>
                                        <div class="bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20 p-3 rounded-full">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-purple-600 dark:text-purple-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                            </svg>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Analytics Charts -->
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                <!-- Orders by Category -->
                                <div class="bg-white dark:bg-dark-card rounded-lg shadow-sm p-6">
                                    <h3 class="text-lg font-semibold mb-4">Orders by Category</h3>
                                    <div class="h-60 flex items-center justify-center">
                                        <div id="categoryChart" class="w-full h-full">
                                            <!-- Simple bar chart using HTML/CSS -->
                                            <div class="h-full flex items-end justify-around gap-2">
                                                <div class="flex flex-col items-center">
                                                    <div class="w-16 bg-blue-500 dark:bg-blue-600 rounded-t-md" style="height: 65%"></div>
                                                    <span class="text-xs mt-2">Seeds</span>
                                                    <span class="text-xs text-gray-500 dark:text-gray-400">65%</span>
                                                </div>
                                                <div class="flex flex-col items-center">
                                                    <div class="w-16 bg-green-500 dark:bg-green-600 rounded-t-md" style="height: 40%"></div>
                                                    <span class="text-xs mt-2">Fertilizers</span>
                                                    <span class="text-xs text-gray-500 dark:text-gray-400">40%</span>
                                                </div>
                                                <div class="flex flex-col items-center">
                                                    <div class="w-16 bg-yellow-500 dark:bg-yellow-600 rounded-t-md" style="height: 25%"></div>
                                                    <span class="text-xs mt-2">Pesticides</span>
                                                    <span class="text-xs text-gray-500 dark:text-gray-400">25%</span>
                                                </div>
                                                <div class="flex flex-col items-center">
                                                    <div class="w-16 bg-purple-500 dark:bg-purple-600 rounded-t-md" style="height: 15%"></div>
                                                    <span class="text-xs mt-2">Equipment</span>
                                                    <span class="text-xs text-gray-500 dark:text-gray-400">15%</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Monthly Trends -->
                                <div class="bg-white dark:bg-dark-card rounded-lg shadow-sm p-6">
                                    <h3 class="text-lg font-semibold mb-4">Monthly Order Trends</h3>
                                    <div class="h-60 flex items-center justify-center">
                                        <div id="trendsChart" class="w-full h-full">
                                            <!-- Simple line chart using HTML/CSS -->
                                            <div class="h-full flex items-end relative">
                                                <div class="absolute bottom-0 left-0 right-0 h-px bg-gray-200 dark:bg-gray-700"></div>
                                                <div class="absolute left-0 bottom-0 top-0 w-px bg-gray-200 dark:bg-gray-700"></div>
                                                
                                                <svg class="w-full h-full" viewBox="0 0 300 150" preserveAspectRatio="none">
                                                    <polyline
                                                        points="0,120 50,100 100,110 150,80 200,60 250,70 300,50"
                                                        fill="none"
                                                        stroke="#5D5CDE"
                                                        stroke-width="2"
                                                    />
                                                    <polyline
                                                        points="0,120 50,100 100,110 150,80 200,60 250,70 300,50"
                                                        fill="rgba(93, 92, 222, 0.1)"
                                                        stroke="none"
                                                        points-to-close="0,150 300,150"
                                                    />
                                                </svg>
                                                
                                                <div class="absolute bottom-0 w-full flex justify-between px-4 text-xs text-gray-500 dark:text-gray-400">
                                                    <div>Jan</div>
                                                    <div>Feb</div>
                                                    <div>Mar</div>
                                                    <div>Apr</div>
                                                    <div>May</div>
                                                    <div>Jun</div>
                                                    <div>Jul</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Top Products and Delivery Performance -->
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                <!-- Top Products -->
                                <div class="bg-white dark:bg-dark-card rounded-lg shadow-sm p-6">
                                    <h3 class="text-lg font-semibold mb-4">Top Products</h3>
                                    <div class="overflow-x-auto">
                                        <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                            <thead>
                                                <tr>
                                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Product</th>
                                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Category</th>
                                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Orders</th>
                                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Total Value</th>
                                                </tr>
                                            </thead>
                                            <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="topProductsTable">
                                                <tr>
                                                    <td class="px-4 py-3">Premium Wheat Seeds</td>
                                                    <td class="px-4 py-3">Seeds</td>
                                                    <td class="px-4 py-3">42</td>
                                                    <td class="px-4 py-3">$4,850</td>
                                                </tr>
                                                <tr>
                                                    <td class="px-4 py-3">Organic NPK Fertilizer</td>
                                                    <td class="px-4 py-3">Fertilizers</td>
                                                    <td class="px-4 py-3">38</td>
                                                    <td class="px-4 py-3">$3,960</td>
                                                </tr>
                                                <tr>
                                                    <td class="px-4 py-3">Hybrid Corn Seeds</td>
                                                    <td class="px-4 py-3">Seeds</td>
                                                    <td class="px-4 py-3">35</td>
                                                    <td class="px-4 py-3">$3,850</td>
                                                </tr>
                                                <tr>
                                                    <td class="px-4 py-3">Bio Pest Control</td>
                                                    <td class="px-4 py-3">Pesticides</td>
                                                    <td class="px-4 py-3">29</td>
                                                    <td class="px-4 py-3">$2,760</td>
                                                </tr>
                                                <tr>
                                                    <td class="px-4 py-3">Drip Irrigation Kit</td>
                                                    <td class="px-4 py-3">Equipment</td>
                                                    <td class="px-4 py-3">24</td>
                                                    <td class="px-4 py-3">$4,320</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                
                                <!-- Delivery Performance -->
                                <div class="bg-white dark:bg-dark-card rounded-lg shadow-sm p-6">
                                    <h3 class="text-lg font-semibold mb-4">Delivery Performance</h3>
                                    <div class="space-y-4">
                                        <div>
                                            <div class="flex justify-between mb-1">
                                                <span class="text-sm font-medium">On-time Deliveries</span>
                                                <span class="text-sm font-medium">85%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5">
                                                <div class="bg-green-500 h-2.5 rounded-full" style="width: 85%"></div>
                                            </div>
                                        </div>
                                        <div>
                                            <div class="flex justify-between mb-1">
                                                <span class="text-sm font-medium">Delayed Deliveries</span>
                                                <span class="text-sm font-medium">12%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5">
                                                <div class="bg-yellow-500 h-2.5 rounded-full" style="width: 12%"></div>
                                            </div>
                                        </div>
                                        <div>
                                            <div class="flex justify-between mb-1">
                                                <span class="text-sm font-medium">Cancelled Orders</span>
                                                <span class="text-sm font-medium">3%</span>
                                            </div>
                                            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5">
                                                <div class="bg-red-500 h-2.5 rounded-full" style="width: 3%"></div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="mt-6">
                                        <h4 class="text-sm font-medium mb-2">Average Delivery Times by Region</h4>
                                        <div class="space-y-3">
                                            <div class="flex justify-between">
                                                <span class="text-sm">North Region</span>
                                                <span class="text-sm font-medium">2.3 days</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-sm">South Region</span>
                                                <span class="text-sm font-medium">3.5 days</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-sm">East Region</span>
                                                <span class="text-sm font-medium">4.1 days</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-sm">West Region</span>
                                                <span class="text-sm font-medium">3.2 days</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <!-- New Order Modal -->
    <div id="newOrderModal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50">
        <div class="bg-white dark:bg-dark-card rounded-lg shadow-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold">Place New Order</h2>
                    <button class="close-modal text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
                <form id="newOrderForm">
                    <div class="mb-4">
                        <label for="orderSupplier" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Select Supplier</label>
                        <select id="orderSupplier" class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-dark-bg text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary" required>
                            <option value="">-- Select a Supplier --</option>
                            <option value="AgriSupply Inc.">AgriSupply Inc.</option>
                            <option value="Farm Fresh Solutions">Farm Fresh Solutions</option>
                            <option value="GreenGrow Supplies">GreenGrow Supplies</option>
                            <option value="Harvest Helpers">Harvest Helpers</option>
                        </select>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Select Products</label>
                        <div class="border border-gray-300 dark:border-gray-600 rounded-md p-4 max-h-60 overflow-y-auto" id="productSelectionContainer">
                            <!-- Product selection will be loaded here -->
                            <div class="flex items-center justify-between py-2 border-b border-gray-200 dark:border-gray-700">
                                <div class="flex items-center">
                                    <input type="checkbox" id="product1" name="products[]" value="1" class="product-checkbox h-4 w-4 text-primary focus:ring-primary border-gray-300 dark:border-gray-600 rounded">
                                    <label for="product1" class="ml-2 block">Premium Wheat Seeds</label>
                                </div>
                                <div class="text-sm text-gray-500 dark:text-gray-400">$45.00/kg</div>
                            </div>
                            <div class="flex items-center justify-between py-2 border-b border-gray-200 dark:border-gray-700">
                                <div class="flex items-center">
                                    <input type="checkbox" id="product2" name="products[]" value="2" class="product-checkbox h-4 w-4 text-primary focus:ring-primary border-gray-300 dark:border-gray-600 rounded">
                                    <label for="product2" class="ml-2 block">Organic NPK Fertilizer</label>
                                </div>
                                <div class="text-sm text-gray-500 dark:text-gray-400">$32.50/bag</div>
                            </div>
                            <div class="flex items-center justify-between py-2 border-b border-gray-200 dark:border-gray-700">
                                <div class="flex items-center">
                                    <input type="checkbox" id="product3" name="products[]" value="3" class="product-checkbox h-4 w-4 text-primary focus:ring-primary border-gray-300 dark:border-gray-600 rounded">
                                    <label for="product3" class="ml-2 block">Hybrid Corn Seeds</label>
                                </div>
                                <div class="text-sm text-gray-500 dark:text-gray-400">$38.75/kg</div>
                            </div>
                            <div class="flex items-center justify-between py-2 border-b border-gray-200 dark:border-gray-700">
                                <div class="flex items-center">
                                    <input type="checkbox" id="product4" name="products[]" value="4" class="product-checkbox h-4 w-4 text-primary focus:ring-primary border-gray-300 dark:border-gray-600 rounded">
                                    <label for="product4" class="ml-2 block">Bio Pest Control</label>
                                </div>
                                <div class="text-sm text-gray-500 dark:text-gray-400">$29.99/bottle</div>
                            </div>
                            <div class="flex items-center justify-between py-2">
                                <div class="flex items-center">
                                    <input type="checkbox" id="product5" name="products[]" value="5" class="product-checkbox h-4 w-4 text-primary focus:ring-primary border-gray-300 dark:border-gray-600 rounded">
                                    <label for="product5" class="ml-2 block">Drip Irrigation Kit</label>
                                </div>
                                <div class="text-sm text-gray-500 dark:text-gray-400">$120.00/set</div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="selectedProductsContainer" class="mb-4 hidden">
                        <h3 class="text-md font-medium mb-2">Selected Products</h3>
                        <div id="selectedProductsList" class="space-y-3">
                            <!-- Selected products with quantities will be shown here -->
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label for="orderNotes" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Order Notes (Optional)</label>
                        <textarea id="orderNotes" rows="3" class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-dark-bg text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary" placeholder="Add any special instructions or notes..."></textarea>
                    </div>
                    
                    <div class="mb-4">
                        <label for="deliveryAddress" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Delivery Address</label>
                        <textarea id="deliveryAddress" rows="2" class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-dark-bg text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary" required placeholder="Enter your delivery address..."></textarea>
                    </div>
                    
                    <div class="mb-4">
                        <label for="deliveryDate" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Preferred Delivery Date</label>
                        <input type="date" id="deliveryDate" class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-dark-bg text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary" required>
                    </div>
                    
                    <div class="border-t border-gray-200 dark:border-gray-700 pt-4 mt-6">
                        <div class="flex justify-between mb-2">
                            <span class="font-medium">Subtotal:</span>
                            <span id="orderSubtotal">$0.00</span>
                        </div>
                        <div class="flex justify-between mb-2">
                            <span class="font-medium">Delivery Fee:</span>
                            <span id="orderDeliveryFee">$0.00</span>
                        </div>
                        <div class="flex justify-between font-bold text-lg">
                            <span>Total:</span>
                            <span id="orderTotal">$0.00</span>
                        </div>
                    </div>
                    
                    <div class="mt-6 flex justify-end space-x-3">
                        <button type="button" class="close-modal px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">Cancel</button>
                        <button type="submit" id="placeOrderSubmitBtn" class="px-4 py-2 bg-primary text-white rounded-md hover:bg-secondary transition-colors">
                            <div class="flex items-center space-x-2">
                                <span>Place Order</span>
                            </div>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Order Details Modal -->
    <div id="orderDetailsModal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50">
        <div class="bg-white dark:bg-dark-card rounded-lg shadow-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold" id="orderDetailsTitle">Order #ORD-12345</h2>
                    <button class="close-modal text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
                
                <!-- Order Status & Info -->
                <div class="mb-6">
                    <div class="flex flex-col sm:flex-row justify-between mb-4">
                        <div>
                            <span id="orderDetailsStatus" class="inline-block px-3 py-1 text-sm rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-30 dark:text-yellow-300">In Transit</span>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mt-1" id="orderDetailsDate">Ordered on: May 15, 2023</p>
                        </div>
                        <div class="mt-2 sm:mt-0 text-right">
                            <p class="text-sm text-gray-600 dark:text-gray-400">Order ID: <span id="orderDetailsId">ORD-12345</span></p>
                            <p class="text-sm text-gray-600 dark:text-gray-400" id="orderDetailsDeliveryDate">Estimated Delivery: May 20, 2023</p>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div class="supplier-only">
                            <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300">Farmer</h4>
                            <p class="mt-1" id="orderDetailsFarmer">John Smith Farm</p>
                            <p class="text-sm text-gray-600 dark:text-gray-400" id="orderDetailsFarmerContact">Phone: +1 (555) 123-4567</p>
                        </div>
                        <div class="farmer-only">
                            <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300">Supplier</h4>
                            <p class="mt-1" id="orderDetailsSupplier">AgriSupply Inc.</p>
                            <p class="text-sm text-gray-600 dark:text-gray-400" id="orderDetailsSupplierContact">Phone: +1 (555) 987-6543</p>
                        </div>
                        <div>
                            <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300">Delivery Address</h4>
                            <p class="mt-1" id="orderDetailsAddress">123 Farm Lane, Rural County, State 12345</p>
                        </div>
                    </div>
                </div>
                
                <!-- Order Items -->
                <h3 class="text-lg font-semibold mb-3">Order Items</h3>
                <div class="overflow-x-auto mb-6">
                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                        <thead>
                            <tr>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Product</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Quantity</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Price</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Total</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="orderDetailsItems">
                            <!-- Order items will be loaded here -->
                        </tbody>
                    </table>
                </div>
                
                <!-- Order Totals -->
                <div class="border-t border-gray-200 dark:border-gray-700 pt-4 mb-6">
                    <div class="flex justify-between mb-2">
                        <span class="font-medium">Subtotal:</span>
                        <span id="orderDetailsSubtotal">$215.50</span>
                    </div>
                    <div class="flex justify-between mb-2">
                        <span class="font-medium">Delivery Fee:</span>
                        <span id="orderDetailsDeliveryFee">$25.00</span>
                    </div>
                    <div class="flex justify-between font-bold text-lg">
                        <span>Total:</span>
                        <span id="orderDetailsTotal">$240.50</span>
                    </div>
                </div>
                
                <!-- Order Notes -->
                <div class="mb-6">
                    <h4 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Order Notes</h4>
                    <p id="orderDetailsNotes" class="text-sm border-l-4 border-gray-300 dark:border-gray-600 pl-3 py-2">Please deliver during morning hours if possible. Gate access code: 1234</p>
                </div>
                
                <!-- Actions -->
                <div class="border-t border-gray-200 dark:border-gray-700 pt-4 flex flex-wrap justify-end gap-3">
                    <button class="close-modal px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">Close</button>
                    
                    <button id="viewDeliveryDetailsBtn" class="px-4 py-2 border border-blue-500 text-blue-500 rounded-md hover:bg-blue-50 dark:hover:bg-blue-900 dark:hover:bg-opacity-30 transition-colors">
                        <div class="flex items-center space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                            </svg>
                            <span>Track Delivery</span>
                        </div>
                    </button>
                    
                    <button id="approveOrderBtn" class="supplier-only hidden px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors">
                        <div class="flex items-center space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                            </svg>
                            <span>Approve Order</span>
                        </div>
                    </button>
                    
                    <button id="markShippedBtn" class="supplier-only hidden px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors">
                        <div class="flex items-center space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path d="M9 17a2 2 0 11-4 0 2 2 0 014 0zM19 17a2 2 0 11-4 0 2 2 0 014 0z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l3.414 3.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0m-4 0a2 2 0 114 0m6 0a2 2 0 104 0m-4 0a2 2 0 114 0" />
                            </svg>
                            <span>Mark as Shipped</span>
                        </div>
                    </button>
                    
                    <button id="markDeliveredBtn" class="supplier-only hidden px-4 py-2 bg-primary text-white rounded-md hover:bg-secondary transition-colors">
                        <div class="flex items-center space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                            </svg>
                            <span>Mark as Delivered</span>
                        </div>
                    </button>
                    
                    <button id="confirmReceiptBtn" class="farmer-only hidden px-4 py-2 bg-primary text-white rounded-md hover:bg-secondary transition-colors">
                        <div class="flex items-center space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                            </svg>
                            <span>Confirm Receipt</span>
                        </div>
                    </button>
                    
                    <button id="cancelOrderBtn" class="hidden px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors">
                        <div class="flex items-center space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                            </svg>
                            <span>Cancel Order</span>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Add Product Modal (Supplier) -->
    <div id="addProductModal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50">
        <div class="bg-white dark:bg-dark-card rounded-lg shadow-lg max-w-lg w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold">Add New Product</h2>
                    <button class="close-modal text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
                <form id="addProductForm">
                    <div class="mb-4">
                        <label for="productName" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Product Name</label>
                        <input type="text" id="productName" class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-dark-bg text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary" required placeholder="Enter product name...">
                    </div>
                    
                    <div class="mb-4">
                        <label for="productCategory" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Category</label>
                        <select id="productCategory" class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-dark-bg text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary" required>
                            <option value="">-- Select Category --</option>
                            <option value="seeds">Seeds</option>
                            <option value="fertilizers">Fertilizers</option>
                            <option value="pesticides">Pesticides</option>
                            <option value="equipment">Equipment</option>
                        </select>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div>
                            <label for="productPrice" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Price</label>
                            <div class="relative">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="text-gray-500 dark:text-gray-400">$</span>
                                </div>
                                <input type="number" id="productPrice" min="0.01" step="0.01" class="w-full border border-gray-300 dark:border-gray-600 rounded-md pl-7 pr-3 py-2 bg-white dark:bg-dark-bg text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary" required placeholder="0.00">
                            </div>
                        </div>
                        <div>
                            <label for="productUnit" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Unit</label>
                            <input type="text" id="productUnit" class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-dark-bg text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary" required placeholder="e.g., kg, bag, bottle">
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label for="productStock" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Stock Quantity</label>
                        <input type="number" id="productStock" min="0" class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-dark-bg text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary" required placeholder="Enter available quantity...">
                    </div>
                    
                    <div class="mb-4">
                        <label for="productDescription" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Description</label>
                        <textarea id="productDescription" rows="3" class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 bg-white dark:bg-dark-bg text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary" required placeholder="Describe the product..."></textarea>
                    </div>
                    
                    <div class="mt-6 flex justify-end space-x-3">
                        <button type="button" class="close-modal px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">Cancel</button>
                        <button type="submit" class="px-4 py-2 bg-primary text-white rounded-md hover:bg-secondary transition-colors">
                            <div class="flex items-center space-x-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                                </svg>
                                <span>Add Product</span>
                            </div>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Notifications Panel -->
    <div id="notificationsPanel" class="hidden fixed right-0 top-16 mt-2 w-80 bg-white dark:bg-dark-card rounded-md shadow-lg z-50 overflow-hidden">
        <div class="p-4 border-b border-gray-200 dark:border-gray-700">
            <div class="flex justify-between items-center">
                <h3 class="font-semibold">Notifications</h3>
                <button id="markAllReadBtn" class="text-sm text-primary hover:text-secondary">Mark all as read</button>
            </div>
        </div>
        <div id="notificationsList" class="max-h-96 overflow-y-auto">
            <!-- Notifications will be loaded here -->
        </div>
        <div class="p-3 text-center border-t border-gray-200 dark:border-gray-700">
            <button id="viewAllNotificationsBtn" class="text-sm text-primary hover:text-secondary">View all notifications</button>
        </div>
    </div>
    
    <!-- Toast Notifications -->
    <div id="toastContainer" class="fixed bottom-4 right-4 z-50 flex flex-col space-y-2">
        <!-- Toasts will be appended here -->
    </div>

    <script>
        // Initialize dark mode
        function initDarkMode() {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                document.documentElement.classList.add('dark');
            }
            
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
                if (event.matches) {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
            });
            
            document.getElementById('toggleDarkMode').addEventListener('click', () => {
                document.documentElement.classList.toggle('dark');
            });
        }
        
        // Mock data for the application
        const mockData = {
            // Current user (can be 'farmer' or 'supplier')
            currentUserType: 'farmer',
            currentUser: {
                farmer: {
                    id: 'farmer-1',
                    name: 'John Smith',
                    farm: 'Smith Family Farm',
                    address: '123 Farm Lane, Rural County, State 12345',
                    contact: '+1 (555) 123-4567',
                    initials: 'JS'
                },
                supplier: {
                    id: 'supplier-1',
                    name: 'Sarah Johnson',
                    company: 'AgriSupply Inc.',
                    address: '456 Supply Road, Business District, State 54321',
                    contact: '+1 (555) 987-6543',
                    initials: 'SJ'
                }
            },
            
            // Orders data
            orders: [
                {
                    id: 'ORD-12345',
                    farmerId: 'farmer-1',
                    farmer: 'John Smith Farm',
                    supplierId: 'supplier-1',
                    supplier: 'AgriSupply Inc.',
                    date: '2023-05-15',
                    deliveryDate: '2023-05-20',
                    status: 'in-transit',
                    address: '123 Farm Lane, Rural County, State 12345',
                    items: [
                        { product: 'Premium Wheat Seeds', quantity: 3, price: 45.00, total: 135.00 },
                        { product: 'Organic NPK Fertilizer', quantity: 2, price: 32.50, total: 65.00 }
                    ],
                    subtotal: 200.00,
                    deliveryFee: 25.00,
                    total: 225.00,
                    notes: 'Please deliver during morning hours if possible. Gate access code: 1234',
                    tracking: [
                        { date: '2023-05-15T10:30:00', status: 'Order Placed', description: 'Your order has been received' },
                        { date: '2023-05-16T09:15:00', status: 'Order Confirmed', description: 'Your order has been approved by the supplier' },
                        { date: '2023-05-17T14:45:00', status: 'Preparing for Shipment', description: 'Your order is being prepared for shipment' },
                        { date: '2023-05-18T08:20:00', status: 'Shipped', description: 'Your order has been shipped and is on the way' }
                    ]
                },
                {
                    id: 'ORD-12346',
                    farmerId: 'farmer-1',
                    farmer: 'John Smith Farm',
                    supplierId: 'supplier-2',
                    supplier: 'Farm Fresh Solutions',
                    date: '2023-05-10',
                    deliveryDate: '2023-05-14',
                    status: 'delivered',
                    address: '123 Farm Lane, Rural County, State 12345',
                    items: [
                        { product: 'Hybrid Corn Seeds', quantity: 2, price: 38.75, total: 77.50 },
                        { product: 'Bio Pest Control', quantity: 1, price: 29.99, total: 29.99 }
                    ],
                    subtotal: 107.49,
                    deliveryFee: 15.00,
                    total: 122.49,
                    notes: '',
                    tracking: [
                        { date: '2023-05-10T11:20:00', status: 'Order Placed', description: 'Your order has been received' },
                        { date: '2023-05-10T15:45:00', status: 'Order Confirmed', description: 'Your order has been approved by the supplier' },
                        { date: '2023-05-11T09:30:00', status: 'Preparing for Shipment', description: 'Your order is being prepared for shipment' },
                        { date: '2023-05-12T08:15:00', status: 'Shipped', description: 'Your order has been shipped and is on the way' },
                        { date: '2023-05-14T13:40:00', status: 'Delivered', description: 'Your order has been delivered' }
                    ]
                },
                {
                    id: 'ORD-12347',
                    farmerId: 'farmer-1',
                    farmer: 'John Smith Farm',
                    supplierId: 'supplier-1',
                    supplier: 'AgriSupply Inc.',
                    date: '2023-05-18',
                    deliveryDate: '2023-05-23',
                    status: 'pending',
                    address: '123 Farm Lane, Rural County, State 12345',
                    items: [
                        { product: 'Drip Irrigation Kit', quantity: 1, price: 120.00, total: 120.00 }
                    ],
                    subtotal: 120.00,
                    deliveryFee: 30.00,
                    total: 150.00,
                    notes: 'Please call before delivery',
                    tracking: [
                        { date: '2023-05-18T16:10:00', status: 'Order Placed', description: 'Your order has been received' }
                    ]
                }
            ],
            
            // Products data (for supplier inventory)
            products: [
                {
                    id: 1,
                    name: 'Premium Wheat Seeds',
                    category: 'seeds',
                    price: 45.00,
                    unit: 'kg',
                    stock: 250,
                    description: 'High-yield wheat seeds perfect for most climate conditions. Disease resistant variety that produces excellent quality grain.'
                },
                {
                    id: 2,
                    name: 'Organic NPK Fertilizer',
                    category: 'fertilizers',
                    price: 32.50,
                    unit: 'bag',
                    stock: 120,
                    description: 'Balanced NPK formula (10-10-10) for general purpose fertilization. OMRI certified for organic farming.'
                },
                {
                    id: 3,
                    name: 'Hybrid Corn Seeds',
                    category: 'seeds',
                    price: 38.75,
                    unit: 'kg',
                    stock: 175,
                    description: 'Drought-resistant hybrid corn seeds with excellent yield potential. Fast maturity and strong stalks.'
                },
                {
                    id: 4,
                    name: 'Bio Pest Control',
                    category: 'pesticides',
                    price: 29.99,
                    unit: 'bottle',
                    stock: 80,
                    description: 'Natural pest control solution safe for organic farming. Controls a wide variety of common agricultural pests.'
                },
                {
                    id: 5,
                    name: 'Drip Irrigation Kit',
                    category: 'equipment',
                    price: 120.00,
                    unit: 'set',
                    stock: 35,
                    description: 'Complete drip irrigation system for up to 1/4 acre. Water-efficient design with durable components and easy installation.'
                }
            ],
            
            // Notifications
            notifications: [
                {
                    id: 'notif-1',
                    userType: 'farmer',
                    title: 'Order Shipped',
                    message: 'Your order #ORD-12345 has been shipped and is on the way.',
                    timestamp: '2023-05-18T08:20:00',
                    read: false,
                    orderId: 'ORD-12345'
                },
                {
                    id: 'notif-2',
                    userType: 'farmer',
                    title: 'Order Delivered',
                    message: 'Your order #ORD-12346 has been delivered. Please confirm receipt when convenient.',
                    timestamp: '2023-05-14T13:40:00',
                    read: false,
                    orderId: 'ORD-12346'
                },
                {
                    id: 'notif-3',
                    userType: 'supplier',
                    title: 'New Order Received',
                    message: 'You have received a new order #ORD-12347 from John Smith Farm.',
                    timestamp: '2023-05-18T16:10:00',
                    read: false,
                    orderId: 'ORD-12347'
                }
            ],
            
            // Activity feed
            activities: [
                {
                    id: 'activity-1',
                    userType: 'both',
                    date: '2023-05-18T08:20:00',
                    activity: 'Order #ORD-12345 has been shipped',
                    status: 'success'
                },
                {
                    id: 'activity-2',
                    userType: 'both',
                    date: '2023-05-18T16:10:00',
                    activity: 'New order #ORD-12347 placed',
                    status: 'info'
                },
                {
                    id: 'activity-3',
                    userType: 'both',
                    date: '2023-05-14T13:40:00',
                    activity: 'Order #ORD-12346 has been delivered',
                    status: 'success'
                },
                {
                    id: 'activity-4',
                    userType: 'supplier',
                    date: '2023-05-17T10:25:00',
                    activity: 'Inventory updated: Added 100kg Premium Wheat Seeds',
                    status: 'info'
                },
                {
                    id: 'activity-5',
                    userType: 'farmer',
                    date: '2023-05-16T09:15:00',
                    activity: 'Order #ORD-12345 has been confirmed',
                    status: 'info'
                }
            ]
        };
        
        // Helper functions
        function formatDate(dateStr) {
            const options = { year: 'numeric', month: 'long', day: 'numeric' };
            return new Date(dateStr).toLocaleDateString(undefined, options);
        }
        
        function formatDateTime(dateStr) {
            const options = { year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit' };
            return new Date(dateStr).toLocaleDateString(undefined, options);
        }
        
        function formatCurrency(amount) {
            return '$' + parseFloat(amount).toFixed(2);
        }
        
        function getStatusClass(status) {
            switch(status) {
                case 'pending':
                    return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-30 dark:text-yellow-300';
                case 'approved':
                    return 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:bg-opacity-30 dark:text-blue-300';
                case 'in-transit':
                    return 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:bg-opacity-30 dark:text-purple-300';
                case 'delivered':
                    return 'bg-green-100 text-green-800 dark:bg-green-900 dark:bg-opacity-30 dark:text-green-300';
                case 'cancelled':
                    return 'bg-red-100 text-red-800 dark:bg-red-900 dark:bg-opacity-30 dark:text-red-300';
                default:
                    return 'bg-gray-100 text-gray-800 dark:bg-gray-900 dark:bg-opacity-30 dark:text-gray-300';
            }
        }
        
        function getStatusLabel(status) {
            switch(status) {
                case 'pending':
                    return 'Pending';
                case 'approved':
                    return 'Approved';
                case 'in-transit':
                    return 'In Transit';
                case 'delivered':
                    return 'Delivered';
                case 'cancelled':
                    return 'Cancelled';
                default:
                    return status.charAt(0).toUpperCase() + status.slice(1).replace('-', ' ');
            }
        }
        
        function showToast(message, type = 'success', duration = 3000) {
            const toastContainer = document.getElementById('toastContainer');
            
            const toast = document.createElement('div');
            toast.className = `max-w-sm p-4 rounded-lg shadow-lg flex items-center space-x-3 transition-all duration-300 transform translate-x-full`;
            
            // Set background color based on type
            if (type === 'success') {
                toast.classList.add('bg-green-100', 'dark:bg-green-900', 'dark:bg-opacity-70', 'text-green-800', 'dark:text-green-200');
            } else if (type === 'error') {
                toast.classList.add('bg-red-100', 'dark:bg-red-900', 'dark:bg-opacity-70', 'text-red-800', 'dark:text-red-200');
            } else if (type === 'info') {
                toast.classList.add('bg-blue-100', 'dark:bg-blue-900', 'dark:bg-opacity-70', 'text-blue-800', 'dark:text-blue-200');
            } else if (type === 'warning') {
                toast.classList.add('bg-yellow-100', 'dark:bg-yellow-900', 'dark:bg-opacity-70', 'text-yellow-800', 'dark:text-yellow-200');
            }
            
            // Icon based on type
            let iconSvg = '';
            if (type === 'success') {
                iconSvg = `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                </svg>`;
            } else if (type === 'error') {
                iconSvg = `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>`;
            } else if (type === 'info') {
                iconSvg = `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>`;
            } else if (type === 'warning') {
                iconSvg = `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                </svg>`;
            }
            
            toast.innerHTML = `
                <div>${iconSvg}</div>
                <div class="flex-1">${message}</div>
                <button class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 focus:outline-none">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            `;
            
            toastContainer.appendChild(toast);
            
            // Slide in animation
            setTimeout(() => {
                toast.classList.remove('translate-x-full');
            }, 10);
            
            // Set up close button
            toast.querySelector('button').addEventListener('click', () => {
                toast.classList.add('translate-x-full', 'opacity-0');
                setTimeout(() => {
                    toast.remove();
                }, 300);
            });
            
            // Auto-remove after duration
            setTimeout(() => {
                toast.classList.add('translate-x-full', 'opacity-0');
                setTimeout(() => {
                    toast.remove();
                }, 300);
            }, duration);
        }
        
        // Application initialization
        function initApp() {
            initDarkMode();
            updateUserInterface();
            loadDashboard();
            setupEventListeners();
        }
        
        // Update UI based on user type
        function updateUserInterface() {
            const userType = mockData.currentUserType;
            const user = mockData.currentUser[userType];
            
            // Update user info
            document.getElementById('userName').textContent = userType === 'farmer' ? user.name : user.name;
            document.getElementById('userRole').textContent = `You are logged in as a ${userType.charAt(0).toUpperCase() + userType.slice(1)}.`;
            document.getElementById('userInitials').textContent = user.initials;
            
            // Show/hide elements based on user type
            document.querySelectorAll('.farmer-only').forEach(el => {
                el.style.display = userType === 'farmer' ? '' : 'none';
            });
            
            document.querySelectorAll('.supplier-only').forEach(el => {
                el.style.display = userType === 'supplier' ? '' : 'none';
            });
            
            // Update notification badge
            updateNotificationBadge();
        }
        
        // Load dashboard data
        function loadDashboard() {
            const userType = mockData.currentUserType;
            
            // Update order counts
            const pendingOrders = mockData.orders.filter(order => order.status === 'pending').length;
            const inTransitOrders = mockData.orders.filter(order => order.status === 'in-transit').length;
            const completedOrders = mockData.orders.filter(order => order.status === 'delivered').length;
            
            document.getElementById('pendingOrdersCount').textContent = pendingOrders;
            document.getElementById('inTransitOrdersCount').textContent = inTransitOrders;
            document.getElementById('completedOrdersCount').textContent = completedOrders;
            
            // Load recent activities
            const recentActivityTable = document.getElementById('recentActivityTable');
            recentActivityTable.innerHTML = '';
            
            mockData.activities
                .filter(activity => activity.userType === 'both' || activity.userType === userType)
                .sort((a, b) => new Date(b.date) - new Date(a.date))
                .slice(0, 5)
                .forEach(activity => {
                    const row = document.createElement('tr');
                    
                    let statusClass = '';
                    if (activity.status === 'success') {
                        statusClass = 'bg-green-100 text-green-800 dark:bg-green-900 dark:bg-opacity-30 dark:text-green-300';
                    } else if (activity.status === 'info') {
                        statusClass = 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:bg-opacity-30 dark:text-blue-300';
                    } else if (activity.status === 'warning') {
                        statusClass = 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-30 dark:text-yellow-300';
                    } else if (activity.status === 'error') {
                        statusClass = 'bg-red-100 text-red-800 dark:bg-red-900 dark:bg-opacity-30 dark:text-red-300';
                    }
                    
                    row.innerHTML = `
                        <td class="px-4 py-3 whitespace-nowrap">${formatDateTime(activity.date)}</td>
                        <td class="px-4 py-3">${activity.activity}</td>
                        <td class="px-4 py-3">
                            <span class="inline-block px-2 py-1 text-xs rounded-full ${statusClass}">
                                ${activity.status.charAt(0).toUpperCase() + activity.status.slice(1)}
                            </span>
                        </td>
                    `;
                    
                    recentActivityTable.appendChild(row);
                });
        }
        
        // Load orders data
        function loadOrders() {
            const userType = mockData.currentUserType;
            const ordersTableBody = document.getElementById('ordersTableBody');
            const ordersTableEmpty = document.getElementById('ordersTableEmpty');
            
            // Get filtered orders based on selection
            const statusFilter = document.getElementById('orderStatusFilter').value;
            const dateFilter = document.getElementById('orderDateFilter').value;
            const searchTerm = document.getElementById('orderSearch').value.toLowerCase();
            
            let filteredOrders = [...mockData.orders];
            
            // Apply status filter
            if (statusFilter !== 'all') {
                filteredOrders = filteredOrders.filter(order => order.status === statusFilter);
            }
            
            // Apply date filter
            if (dateFilter !== 'all') {
                const now = new Date();
                const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                const startOfWeek = new Date(today);
                startOfWeek.setDate(today.getDate() - today.getDay());
                const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);
                const startOfQuarter = new Date(now.getFullYear(), now.getMonth() - 3, 1);
                
                if (dateFilter === 'today') {
                    filteredOrders = filteredOrders.filter(order => new Date(order.date) >= today);
                } else if (dateFilter === 'week') {
                    filteredOrders = filteredOrders.filter(order => new Date(order.date) >= startOfWeek);
                } else if (dateFilter === 'month') {
                    filteredOrders = filteredOrders.filter(order => new Date(order.date) >= startOfMonth);
                } else if (dateFilter === 'quarter') {
                    filteredOrders = filteredOrders.filter(order => new Date(order.date) >= startOfQuarter);
                }
            }
            
            // Apply search filter
            if (searchTerm) {
                filteredOrders = filteredOrders.filter(order => 
                    order.id.toLowerCase().includes(searchTerm) ||
                    order.farmer.toLowerCase().includes(searchTerm) ||
                    order.supplier.toLowerCase().includes(searchTerm) ||
                    order.items.some(item => item.product.toLowerCase().includes(searchTerm))
                );
            }
            
            // Clear table
            ordersTableBody.innerHTML = '';
            
            // Show empty state if no orders
            if (filteredOrders.length === 0) {
                ordersTableEmpty.classList.remove('hidden');
                return;
            }
            
            ordersTableEmpty.classList.add('hidden');
            
            // Sort orders by date (newest first)
            filteredOrders.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            // Populate table
            filteredOrders.forEach(order => {
                const row = document.createElement('tr');
                
                const itemsText = order.items.map(item => `${item.quantity} x ${item.product}`).join(', ');
                
                row.innerHTML = `
                    <td class="px-4 py-3 whitespace-nowrap">
                        <span class="font-medium">${order.id}</span>
                    </td>
                    <td class="px-4 py-3 supplier-only">${order.farmer}</td>
                    <td class="px-4 py-3 farmer-only">${order.supplier}</td>
                    <td class="px-4 py-3 whitespace-nowrap">${formatDate(order.date)}</td>
                    <td class="px-4 py-3">
                        <span class="line-clamp-1">${itemsText}</span>
                    </td>
                    <td class="px-4 py-3 whitespace-nowrap">${formatCurrency(order.total)}</td>
                    <td class="px-4 py-3 whitespace-nowrap">
                        <span class="inline-block px-3 py-1 text-xs rounded-full ${getStatusClass(order.status)}">
                            ${getStatusLabel(order.status)}
                        </span>
                    </td>
                    <td class="px-4 py-3 whitespace-nowrap">
                        <button class="view-order-btn text-primary hover:text-secondary" data-order-id="${order.id}">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                            </svg>
                        </button>
                    </td>
                `;
                
                ordersTableBody.appendChild(row);
            });
            
            // Add event listeners to view order buttons
            document.querySelectorAll('.view-order-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const orderId = btn.getAttribute('data-order-id');
                    showOrderDetails(orderId);
                });
            });
        }
        
        // Load inventory data
        function loadInventory() {
            const productsGrid = document.getElementById('productsGrid');
            const productsGridEmpty = document.getElementById('productsGridEmpty');
            
            // Get filtered products based on selection
            const categoryFilter = document.getElementById('categoryFilter').value;
            const stockFilter = document.getElementById('stockFilter').value;
            const searchTerm = document.getElementById('inventorySearch').value.toLowerCase();
            
            let filteredProducts = [...mockData.products];
            
            // Apply category filter
            if (categoryFilter !== 'all') {
                filteredProducts = filteredProducts.filter(product => product.category === categoryFilter);
            }
            
            // Apply stock filter
            if (stockFilter !== 'all') {
                if (stockFilter === 'in-stock') {
                    filteredProducts = filteredProducts.filter(product => product.stock > 20);
                } else if (stockFilter === 'low-stock') {
                    filteredProducts = filteredProducts.filter(product => product.stock > 0 && product.stock <= 20);
                } else if (stockFilter === 'out-of-stock') {
                    filteredProducts = filteredProducts.filter(product => product.stock <= 0);
                }
            }
            
            // Apply search filter
            if (searchTerm) {
                filteredProducts = filteredProducts.filter(product => 
                    product.name.toLowerCase().includes(searchTerm) ||
                    product.category.toLowerCase().includes(searchTerm) ||
                    product.description.toLowerCase().includes(searchTerm)
                );
            }
            
            // Clear grid
            productsGrid.innerHTML = '';
            
            // Show empty state if no products
            if (filteredProducts.length === 0) {
                productsGridEmpty.classList.remove('hidden');
                return;
            }
            
            productsGridEmpty.classList.add('hidden');
            
            // Populate grid
            filteredProducts.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'bg-white dark:bg-dark-card rounded-lg shadow-sm overflow-hidden';
                
                // Determine stock status and badge
                let stockBadge = '';
                if (product.stock <= 0) {
                    stockBadge = '<span class="absolute top-2 right-2 px-2 py-1 text-xs rounded-full bg-red-100 text-red-800 dark:bg-red-900 dark:bg-opacity-30 dark:text-red-300">Out of Stock</span>';
                } else if (product.stock <= 20) {
                    stockBadge = '<span class="absolute top-2 right-2 px-2 py-1 text-xs rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-30 dark:text-yellow-300">Low Stock</span>';
                }
                
                // Category badge
                let categoryBadge = '';
                if (product.category === 'seeds') {
                    categoryBadge = '<span class="inline-block px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900 dark:bg-opacity-30 dark:text-blue-300">Seeds</span>';
                } else if (product.category === 'fertilizers') {
                    categoryBadge = '<span class="inline-block px-2 py-1 text-xs rounded-full bg-green-100 text-green-800 dark:bg-green-900 dark:bg-opacity-30 dark:text-green-300">Fertilizers</span>';
                } else if (product.category === 'pesticides') {
                    categoryBadge = '<span class="inline-block px-2 py-1 text-xs rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-30 dark:text-yellow-300">Pesticides</span>';
                } else if (product.category === 'equipment') {
                    categoryBadge = '<span class="inline-block px-2 py-1 text-xs rounded-full bg-purple-100 text-purple-800 dark:bg-purple-900 dark:bg-opacity-30 dark:text-purple-300">Equipment</span>';
                }
                
                productCard.innerHTML = `
                    <div class="relative">
                        <div class="bg-gray-100 dark:bg-gray-800 h-32 flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-gray-400 dark:text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" />
                            </svg>
                        </div>
                        ${stockBadge}
                    </div>
                    <div class="p-4">
                        <div class="flex items-center justify-between mb-2">
                            <h3 class="font-semibold">${product.name}</h3>
                            <span class="font-bold">${formatCurrency(product.price)}/${product.unit}</span>
                        </div>
                        <div class="mb-2">
                            ${categoryBadge}
                        </div>
                        <p class="text-sm text-gray-600 dark:text-gray-400 mb-4 line-clamp-2">${product.description}</p>
                        <div class="flex items-center justify-between">
                            <span class="text-sm">Stock: <span class="font-medium">${product.stock} ${product.unit}s</span></span>
                            <button class="edit-product-btn text-primary hover:text-secondary" data-product-id="${product.id}">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                                </svg>
                            </button>
                        </div>
                    </div>
                `;
                
                productsGrid.appendChild(productCard);
            });
        }
        
        // Load tracking data
        function loadOrderTracking(orderId) {
            const trackingResult = document.getElementById('trackingResult');
            const trackingNoResult = document.getElementById('trackingNoResult');
            const trackingEmptyState = document.getElementById('trackingEmptyState');
            
            // Hide all states initially
            trackingResult.classList.add('hidden');
            trackingNoResult.classList.add('hidden');
            trackingEmptyState.classList.add('hidden');
            
            if (!orderId) {
                trackingEmptyState.classList.remove('hidden');
                return;
            }
            
            // Find order
            const order = mockData.orders.find(o => o.id === orderId);
            
            if (!order) {
                trackingNoResult.classList.remove('hidden');
                return;
            }
            
            // Show tracking result
            trackingResult.classList.remove('hidden');
            
            // Update order info
            document.getElementById('trackingOrderId').textContent = `Order #${order.id}`;
            document.getElementById('trackingOrderDate').textContent = `Ordered on: ${formatDate(order.date)}`;
            document.getElementById('trackingOrderStatus').textContent = getStatusLabel(order.status);
            document.getElementById('trackingOrderStatus').className = `inline-block px-3 py-1 text-sm rounded-full ${getStatusClass(order.status)}`;
            document.getElementById('trackingSupplier').textContent = order.supplier;
            document.getElementById('trackingFarmer').textContent = order.farmer;
            document.getElementById('trackingETA').textContent = formatDate(order.deliveryDate);
            
            // Update tracking timeline
            const trackingTimeline = document.getElementById('trackingTimeline');
            trackingTimeline.innerHTML = '';
            
            order.tracking.forEach((event, index) => {
                const isLast = index === order.tracking.length - 1;
                
                const timelineEvent = document.createElement('div');
                timelineEvent.className = `relative ${isLast ? '' : 'pb-6'}`;
                
                timelineEvent.innerHTML = `
                    <div class="flex items-center">
                        <div class="z-10 flex items-center justify-center w-10 h-10 rounded-full bg-primary text-white">
                            ${getStatusIcon(event.status)}
                        </div>
                        <div class="flex-1 ml-4">
                            <div class="font-medium">${event.status}</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">${formatDateTime(event.date)}</div>
                            <div class="text-sm mt-1">${event.description}</div>
                        </div>
                    </div>
                `;
                
                trackingTimeline.appendChild(timelineEvent);
            });
            
            // Update order items
            const trackingItemsTable = document.getElementById('trackingItemsTable');
            trackingItemsTable.innerHTML = '';
            
            order.items.forEach(item => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td class="px-4 py-3">${item.product}</td>
                    <td class="px-4 py-3">${item.quantity}</td>
                    <td class="px-4 py-3">${formatCurrency(item.price)}</td>
                    <td class="px-4 py-3 font-medium">${formatCurrency(item.total)}</td>
                `;
                
                trackingItemsTable.appendChild(row);
            });
        }
        
        // Load recent deliveries for tracking view
        function loadRecentDeliveries() {
            const userType = mockData.currentUserType;
            const recentDeliveriesTable = document.getElementById('recentDeliveriesTable');
            
            // Get recent deliveries (in-transit or delivered)
            const recentDeliveries = mockData.orders
                .filter(order => order.status === 'in-transit' || order.status === 'delivered')
                .sort((a, b) => new Date(b.date) - new Date(a.date));
            
            // Clear table
            recentDeliveriesTable.innerHTML = '';
            
            if (recentDeliveries.length === 0) {
                const emptyRow = document.createElement('tr');
                emptyRow.innerHTML = `
                    <td colspan="6" class="px-4 py-6 text-center text-gray-500 dark:text-gray-400">
                        No recent deliveries found
                    </td>
                `;
                recentDeliveriesTable.appendChild(emptyRow);
                return;
            }
            
            // Populate table
            recentDeliveries.forEach(delivery => {
                const row = document.createElement('tr');
                
                // Get last tracking event
                const lastEvent = delivery.tracking[delivery.tracking.length - 1];
                
                row.innerHTML = `
                    <td class="px-4 py-3 whitespace-nowrap">
                        <span class="font-medium">${delivery.id}</span>
                    </td>
                    <td class="px-4 py-3 supplier-only">${delivery.farmer}</td>
                    <td class="px-4 py-3 farmer-only">${delivery.supplier}</td>
                    <td class="px-4 py-3 whitespace-nowrap">
                        <span class="inline-block px-3 py-1 text-xs rounded-full ${getStatusClass(delivery.status)}">
                            ${getStatusLabel(delivery.status)}
                        </span>
                    </td>
                    <td class="px-4 py-3 whitespace-nowrap">${formatDateTime(lastEvent.date)}</td>
                    <td class="px-4 py-3 whitespace-nowrap">
                        <button class="track-delivery-btn text-primary hover:text-secondary" data-order-id="${delivery.id}">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                            </svg>
                        </button>
                    </td>
                `;
                
                recentDeliveriesTable.appendChild(row);
            });
            
            // Add event listeners to track delivery buttons
            document.querySelectorAll('.track-delivery-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const orderId = btn.getAttribute('data-order-id');
                    document.getElementById('trackingOrderSearch').value = orderId;
                    loadOrderTracking(orderId);
                });
            });
        }
        
        // Update notification badge
        function updateNotificationBadge() {
            const userType = mockData.currentUserType;
            const unreadNotifications = mockData.notifications.filter(
                notif => notif.userType === userType && !notif.read
            ).length;
            
            const badge = document.getElementById('notificationBadge');
            
            if (unreadNotifications > 0) {
                badge.textContent = unreadNotifications;
                badge.classList.remove('hidden');
            } else {
                badge.classList.add('hidden');
            }
        }
        
        // Load notifications
        function loadNotifications() {
            const userType = mockData.currentUserType;
            const notificationsList = document.getElementById('notificationsList');
            
            // Get user's notifications
            const userNotifications = mockData.notifications
                .filter(notif => notif.userType === userType)
                .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            
            // Clear list
            notificationsList.innerHTML = '';
            
            if (userNotifications.length === 0) {
                const emptyNotification = document.createElement('div');
                emptyNotification.className = 'p-4 text-center text-gray-500 dark:text-gray-400';
                emptyNotification.textContent = 'No notifications';
                notificationsList.appendChild(emptyNotification);
                return;
            }
            
            // Populate list
            userNotifications.forEach(notification => {
                const notificationItem = document.createElement('div');
                notificationItem.className = `border-b border-gray-200 dark:border-gray-700 last:border-b-0 p-4 ${notification.read ? '' : 'bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20'}`;
                
                notificationItem.innerHTML = `
                    <div class="flex justify-between items-start mb-1">
                        <h4 class="font-medium">${notification.title}</h4>
                        <span class="text-xs text-gray-500 dark:text-gray-400">${formatDateTime(notification.timestamp)}</span>
                    </div>
                    <p class="text-sm text-gray-600 dark:text-gray-300">${notification.message}</p>
                    ${notification.orderId ? `
                        <button class="view-order-notification mt-2 text-sm text-primary hover:text-secondary" data-order-id="${notification.orderId}">
                            View Order
                        </button>
                    ` : ''}
                `;
                
                notificationsList.appendChild(notificationItem);
            });
            
            // Add event listeners to view order buttons
            document.querySelectorAll('.view-order-notification').forEach(btn => {
                btn.addEventListener('click', () => {
                    const orderId = btn.getAttribute('data-order-id');
                    showOrderDetails(orderId);
                    
                    // Close notifications panel
                    document.getElementById('notificationsPanel').classList.add('hidden');
                });
            });
        }
        
        // Show order details modal
        function showOrderDetails(orderId) {
            const order = mockData.orders.find(o => o.id === orderId);
            
            if (!order) {
                showToast('Order not found', 'error');
                return;
            }
            
            const userType = mockData.currentUserType;
            const modal = document.getElementById('orderDetailsModal');
            
            // Update order details
            document.getElementById('orderDetailsTitle').textContent = `Order #${order.id}`;
            document.getElementById('orderDetailsStatus').textContent = getStatusLabel(order.status);
            document.getElementById('orderDetailsStatus').className = `inline-block px-3 py-1 text-sm rounded-full ${getStatusClass(order.status)}`;
            document.getElementById('orderDetailsDate').textContent = `Ordered on: ${formatDate(order.date)}`;
            document.getElementById('orderDetailsId').textContent = order.id;
            document.getElementById('orderDetailsDeliveryDate').textContent = `Estimated Delivery: ${formatDate(order.deliveryDate)}`;
            document.getElementById('orderDetailsSupplier').textContent = order.supplier;
            document.getElementById('orderDetailsSupplierContact').textContent = 'Phone: +1 (555) 987-6543';
            document.getElementById('orderDetailsFarmer').textContent = order.farmer;
            document.getElementById('orderDetailsFarmerContact').textContent = 'Phone: +1 (555) 123-4567';
            document.getElementById('orderDetailsAddress').textContent = order.address;
            
            // Update order items
            const orderDetailsItems = document.getElementById('orderDetailsItems');
            orderDetailsItems.innerHTML = '';
            
            order.items.forEach(item => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td class="px-4 py-3">${item.product}</td>
                    <td class="px-4 py-3">${item.quantity}</td>
                    <td class="px-4 py-3">${formatCurrency(item.price)}</td>
                    <td class="px-4 py-3 font-medium">${formatCurrency(item.total)}</td>
                `;
                
                orderDetailsItems.appendChild(row);
            });
            
            // Update order totals
            document.getElementById('orderDetailsSubtotal').textContent = formatCurrency(order.subtotal);
            document.getElementById('orderDetailsDeliveryFee').textContent = formatCurrency(order.deliveryFee);
            document.getElementById('orderDetailsTotal').textContent = formatCurrency(order.total);
            
            // Update order notes
            document.getElementById('orderDetailsNotes').textContent = order.notes || 'No additional notes';
            
            // Show/hide action buttons based on order status and user type
            document.getElementById('approveOrderBtn').classList.add('hidden');
            document.getElementById('markShippedBtn').classList.add('hidden');
            document.getElementById('markDeliveredBtn').classList.add('hidden');
            document.getElementById('confirmReceiptBtn').classList.add('hidden');
            document.getElementById('cancelOrderBtn').classList.add('hidden');
            
            if (userType === 'supplier') {
                if (order.status === 'pending') {
                    document.getElementById('approveOrderBtn').classList.remove('hidden');
                    document.getElementById('cancelOrderBtn').classList.remove('hidden');
                } else if (order.status === 'approved') {
                    document.getElementById('markShippedBtn').classList.remove('hidden');
                    document.getElementById('cancelOrderBtn').classList.remove('hidden');
                } else if (order.status === 'in-transit') {
                    document.getElementById('markDeliveredBtn').classList.remove('hidden');
                }
            } else if (userType === 'farmer') {
                if (order.status === 'pending') {
                    document.getElementById('cancelOrderBtn').classList.remove('hidden');
                } else if (order.status === 'in-transit') {
                    document.getElementById('confirmReceiptBtn').classList.remove('hidden');
                }
            }
            
            // Show modal
            modal.classList.remove('hidden');
        }
        
        // Show new order modal
        function showNewOrderModal() {
            // Calculate a reasonable delivery fee if price is over a threshold
            function calculateDeliveryFee(subtotal) {
                if (subtotal >= 200) {
                    return 0; // Free delivery for orders over $200
                } else if (subtotal >= 100) {
                    return 15.00; // $15 delivery fee for orders between $100-$200
                } else {
                    return 25.00; // $25 delivery fee for orders under $100
                }
            }
            
            // Reset form
            document.getElementById('newOrderForm').reset();
            document.getElementById('selectedProductsList').innerHTML = '';
            document.getElementById('selectedProductsContainer').classList.add('hidden');
            document.getElementById('orderSubtotal').textContent = formatCurrency(0);
            document.getElementById('orderDeliveryFee').textContent = formatCurrency(0);
            document.getElementById('orderTotal').textContent = formatCurrency(0);
            
            // Set minimum delivery date (tomorrow)
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            const minDate = tomorrow.toISOString().split('T')[0];
            document.getElementById('deliveryDate').min = minDate;
            document.getElementById('deliveryDate').value = minDate;
            
            // Show modal
            document.getElementById('newOrderModal').classList.remove('hidden');
            
            // Update product selection when a checkbox is clicked
            document.querySelectorAll('.product-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', updateSelectedProducts);
            });
            
            // Function to update selected products
            function updateSelectedProducts() {
                const selectedProducts = document.getElementById('selectedProductsList');
                selectedProducts.innerHTML = '';
                
                let subtotal = 0;
                let hasSelectedProducts = false;
                
                document.querySelectorAll('.product-checkbox:checked').forEach(checkbox => {
                    hasSelectedProducts = true;
                    
                    const productId = checkbox.value;
                    const product = mockData.products.find(p => p.id == productId);
                    
                    if (!product) return;
                    
                    const productItem = document.createElement('div');
                    productItem.className = 'flex flex-col sm:flex-row sm:items-center border border-gray-200 dark:border-gray-700 rounded-md p-3';
                    
                    productItem.innerHTML = `
                        <div class="flex-1">
                            <div class="font-medium">${product.name}</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">${formatCurrency(product.price)}/${product.unit}</div>
                        </div>
                        <div class="mt-2 sm:mt-0 flex items-center">
                            <button type="button" class="quantity-btn minus bg-gray-200 dark:bg-gray-700 rounded-l-md px-3 py-1">-</button>
                            <input type="number" min="1" value="1" data-product-id="${product.id}" data-price="${product.price}" class="product-quantity w-16 text-center border-t border-b border-gray-300 dark:border-gray-600 py-1 bg-white dark:bg-dark-bg text-gray-900 dark:text-white">
                            <button type="button" class="quantity-btn plus bg-gray-200 dark:bg-gray-700 rounded-r-md px-3 py-1">+</button>
                            <div class="ml-4 font-medium product-total">${formatCurrency(product.price)}</div>
                        </div>
                    `;
                    
                    subtotal += product.price;
                    selectedProducts.appendChild(productItem);
                    
                    // Add event listeners to quantity buttons
                    const quantityInput = productItem.querySelector('.product-quantity');
                    const totalElement = productItem.querySelector('.product-total');
                    
                    productItem.querySelector('.quantity-btn.minus').addEventListener('click', () => {
                        if (quantityInput.value > 1) {
                            quantityInput.value = parseInt(quantityInput.value) - 1;
                            updateProductTotal(quantityInput, totalElement);
                            updateOrderTotals();
                        }
                    });
                    
                    productItem.querySelector('.quantity-btn.plus').addEventListener('click', () => {
                        quantityInput.value = parseInt(quantityInput.value) + 1;
                        updateProductTotal(quantityInput, totalElement);
                        updateOrderTotals();
                    });
                    
                    quantityInput.addEventListener('change', () => {
                        if (quantityInput.value < 1) quantityInput.value = 1;
                        updateProductTotal(quantityInput, totalElement);
                        updateOrderTotals();
                    });
                });
                
                if (hasSelectedProducts) {
                    document.getElementById('selectedProductsContainer').classList.remove('hidden');
                } else {
                    document.getElementById('selectedProductsContainer').classList.add('hidden');
                }
                
                updateOrderTotals();
                
                // Functions to update product and order totals
                function updateProductTotal(quantityInput, totalElement) {
                    const quantity = parseInt(quantityInput.value);
                    const price = parseFloat(quantityInput.getAttribute('data-price'));
                    const total = quantity * price;
                    totalElement.textContent = formatCurrency(total);
                }
                
                function updateOrderTotals() {
                    let subtotal = 0;
                    
                    document.querySelectorAll('.product-quantity').forEach(input => {
                        const quantity = parseInt(input.value);
                        const price = parseFloat(input.getAttribute('data-price'));
                        subtotal += quantity * price;
                    });
                    
                    const deliveryFee = calculateDeliveryFee(subtotal);
                    const total = subtotal + deliveryFee;
                    
                    document.getElementById('orderSubtotal').textContent = formatCurrency(subtotal);
                    document.getElementById('orderDeliveryFee').textContent = formatCurrency(deliveryFee);
                    document.getElementById('orderTotal').textContent = formatCurrency(total);
                }
            }
        }
        
        // Get status icon for tracking
        function getStatusIcon(status) {
            const statusLower = status.toLowerCase();
            
            if (statusLower.includes('placed') || statusLower.includes('received')) {
                return `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>`;
            } else if (statusLower.includes('confirmed') || statusLower.includes('approved')) {
                return `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>`;
            } else if (statusLower.includes('preparing') || statusLower.includes('processing')) {
                return `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" />
                </svg>`;
            } else if (statusLower.includes('shipped') || statusLower.includes('transit')) {
                return `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path d="M9 17a2 2 0 11-4 0 2 2 0 014 0zM19 17a2 2 0 11-4 0 2 2 0 014 0z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l3.414 3.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0m-4 0a2 2 0 114 0m6 0a2 2 0 104 0m-4 0a2 2 0 114 0" />
                </svg>`;
            } else if (statusLower.includes('delivered')) {
                return `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                </svg>`;
            } else {
                return `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>`;
            }
        }
        
        // Setup event listeners
        function setupEventListeners() {
            // Navigation
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const viewName = btn.getAttribute('data-view');
                    switchView(viewName);
                    
                    // Update active state
                    document.querySelectorAll('.nav-btn').forEach(navBtn => {
                        navBtn.classList.remove('bg-primary', 'bg-opacity-10', 'text-primary');
                        navBtn.classList.add('hover:bg-gray-100', 'dark:hover:bg-gray-700');
                    });
                    
                    btn.classList.add('bg-primary', 'bg-opacity-10', 'text-primary');
                    btn.classList.remove('hover:bg-gray-100', 'dark:hover:bg-gray-700');
                });
            });
            
            // Switch view
            function switchView(viewName) {
                // Hide all views
                document.querySelectorAll('.view-content').forEach(view => {
                    view.classList.add('hidden');
                });
                
                // Show selected view
                const selectedView = document.getElementById(`${viewName}-view`);
                selectedView.classList.remove('hidden');
                
                // Load data for the view
                if (viewName === 'dashboard') {
                    loadDashboard();
                } else if (viewName === 'orders') {
                    loadOrders();
                } else if (viewName === 'inventory') {
                    loadInventory();
                } else if (viewName === 'tracking') {
                    loadRecentDeliveries();
                    loadOrderTracking();
                }
            }
            
            // Quick action buttons
            document.getElementById('placeOrderBtn').addEventListener('click', () => {
                showNewOrderModal();
            });
            
            document.getElementById('newOrderBtn').addEventListener('click', () => {
                showNewOrderModal();
            });
            
            document.getElementById('trackOrderBtn').addEventListener('click', () => {
                switchView('tracking');
            });
            
            document.getElementById('manageInventoryBtn').addEventListener('click', () => {
                switchView('inventory');
            });
            
            // Add product button (Supplier)
            document.getElementById('addProductBtn').addEventListener('click', () => {
                document.getElementById('addProductModal').classList.remove('hidden');
            });
            
            // Track order search
            document.getElementById('trackOrderSearchBtn').addEventListener('click', () => {
                const orderId = document.getElementById('trackingOrderSearch').value.trim();
                loadOrderTracking(orderId);
            });
            
            // Order view details from tracking
            document.getElementById('viewDeliveryDetailsBtn').addEventListener('click', () => {
                const orderId = document.getElementById('trackingOrderId').textContent.replace('Order #', '');
                document.getElementById('orderDetailsModal').classList.add('hidden');
                switchView('tracking');
                document.getElementById('trackingOrderSearch').value = orderId;
                loadOrderTracking(orderId);
            });
            
            // Orders filter change
            document.getElementById('orderStatusFilter').addEventListener('change', loadOrders);
            document.getElementById('orderDateFilter').addEventListener('change', loadOrders);
            document.getElementById('orderSearch').addEventListener('input', loadOrders);
            
            // Inventory filter change
            document.getElementById('categoryFilter').addEventListener('change', loadInventory);
            document.getElementById('stockFilter').addEventListener('change', loadInventory);
            document.getElementById('inventorySearch').addEventListener('input', loadInventory);
            
            // User menu toggle
            document.getElementById('userMenuBtn').addEventListener('click', () => {
                document.getElementById('userMenu').classList.toggle('hidden');
            });
            
            // Switch user type
            document.getElementById('switchUserBtn').addEventListener('click', () => {
                mockData.currentUserType = mockData.currentUserType === 'farmer' ? 'supplier' : 'farmer';
                updateUserInterface();
                loadDashboard();
                document.getElementById('userMenu').classList.add('hidden');
                showToast(`Switched to ${mockData.currentUserType} view`, 'info');
            });
            
            // Close modals
            document.querySelectorAll('.close-modal').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('[id$="Modal"]').forEach(modal => {
                        modal.classList.add('hidden');
                    });
                });
            });
            
            // Close modals when clicking outside
            document.querySelectorAll('[id$="Modal"]').forEach(modal => {
                modal.addEventListener('click', event => {
                    if (event.target === modal) {
                        modal.classList.add('hidden');
                    }
                });
            });
            
            // Notifications panel toggle
            document.getElementById('notificationBtn').addEventListener('click', () => {
                const panel = document.getElementById('notificationsPanel');
                panel.classList.toggle('hidden');
                
                if (!panel.classList.contains('hidden')) {
                    loadNotifications();
                    
                    // Mark notifications as read when opening panel
                    mockData.notifications.forEach(notif => {
                        if (notif.userType === mockData.currentUserType) {
                            notif.read = true;
                        }
                    });
                    
                    updateNotificationBadge();
                    
                    // Close user menu if open
                    document.getElementById('userMenu').classList.add('hidden');
                }
            });
            
            // Mark all notifications as read
            document.getElementById('markAllReadBtn').addEventListener('click', () => {
                mockData.notifications.forEach(notif => {
                    if (notif.userType === mockData.currentUserType) {
                        notif.read = true;
                    }
                });
                
                updateNotificationBadge();
                loadNotifications();
            });
            
            // Close panels when clicking outside
            document.addEventListener('click', event => {
                const userMenu = document.getElementById('userMenu');
                const userMenuBtn = document.getElementById('userMenuBtn');
                const notificationsPanel = document.getElementById('notificationsPanel');
                const notificationBtn = document.getElementById('notificationBtn');
                
                if (!userMenuBtn.contains(event.target) && !userMenu.contains(event.target)) {
                    userMenu.classList.add('hidden');
                }
                
                if (!notificationBtn.contains(event.target) && !notificationsPanel.contains(event.target)) {
                    notificationsPanel.classList.add('hidden');
                }
            });
            
            // Order form submit
            document.getElementById('newOrderForm').addEventListener('submit', event => {
                event.preventDefault();
                
                const selectedProducts = [];
                document.querySelectorAll('.product-quantity').forEach(input => {
                    const productId = input.getAttribute('data-product-id');
                    const quantity = parseInt(input.value);
                    const price = parseFloat(input.getAttribute('data-price'));
                    
                    selectedProducts.push({
                        productId,
                        quantity,
                        price,
                        total: quantity * price
                    });
                });
                
                if (selectedProducts.length === 0) {
                    showToast('Please select at least one product', 'warning');
                    return;
                }
                
                // Process the order
                document.getElementById('newOrderModal').classList.add('hidden');
                showToast('Order placed successfully', 'success');
                
                // Simulate adding the order to the system
                const newOrder = {
                    id: `ORD-${Math.floor(10000 + Math.random() * 90000)}`,
                    farmerId: 'farmer-1',
                    farmer: 'John Smith Farm',
                    supplierId: 'supplier-1',
                    supplier: document.getElementById('orderSupplier').value,
                    date: new Date().toISOString().split('T')[0],
                    deliveryDate: document.getElementById('deliveryDate').value,
                    status: 'pending',
                    address: document.getElementById('deliveryAddress').value,
                    items: selectedProducts.map(p => {
                        const product = mockData.products.find(prod => prod.id == p.productId);
                        return {
                            product: product.name,
                            quantity: p.quantity,
                            price: p.price,
                            total: p.total
                        };
                    }),
                    subtotal: selectedProducts.reduce((sum, p) => sum + p.total, 0),
                    deliveryFee: parseFloat(document.getElementById('orderDeliveryFee').textContent.replace('$', '')),
                    total: parseFloat(document.getElementById('orderTotal').textContent.replace('$', '')),
                    notes: document.getElementById('orderNotes').value,
                    tracking: [
                        { date: new Date().toISOString(), status: 'Order Placed', description: 'Your order has been received' }
                    ]
                };
                
                // Add to mock data
                mockData.orders.unshift(newOrder);
                
                // Add notification for supplier
                mockData.notifications.unshift({
                    id: `notif-${Math.floor(10000 + Math.random() * 90000)}`,
                    userType: 'supplier',
                    title: 'New Order Received',
                    message: `You have received a new order #${newOrder.id} from ${newOrder.farmer}.`,
                    timestamp: new Date().toISOString(),
                    read: false,
                    orderId: newOrder.id
                });
                
                // Add to activity feed
                mockData.activities.unshift({
                    id: `activity-${Math.floor(10000 + Math.random() * 90000)}`,
                    userType: 'both',
                    date: new Date().toISOString(),
                    activity: `New order #${newOrder.id} placed`,
                    status: 'info'
                });
                
                // Reload relevant views
                if (document.getElementById('dashboard-view').classList.contains('hidden')) {
                    switchView('orders');
                } else {
                    loadDashboard();
                }
            });
            
            // Add product form submit
            document.getElementById('addProductForm').addEventListener('submit', event => {
                event.preventDefault();
                
                // Process the product
                document.getElementById('addProductModal').classList.add('hidden');
                showToast('Product added successfully', 'success');
                
                // Simulate adding the product to the system
                const newProduct = {
                    id: mockData.products.length + 1,
                    name: document.getElementById('productName').value,
                    category: document.getElementById('productCategory').value,
                    price: parseFloat(document.getElementById('productPrice').value),
                    unit: document.getElementById('productUnit').value,
                    stock: parseInt(document.getElementById('productStock').value),
                    description: document.getElementById('productDescription').value
                };
                
                // Add to mock data
                mockData.products.push(newProduct);
                
                // Add to activity feed
                mockData.activities.unshift({
                    id: `activity-${Math.floor(10000 + Math.random() * 90000)}`,
                    userType: 'supplier',
                    date: new Date().toISOString(),
                    activity: `Inventory updated: Added ${newProduct.stock} ${newProduct.unit}s of ${newProduct.name}`,
                    status: 'info'
                });
                
                // Reload inventory view
                loadInventory();
            });
            
            // Order action buttons
            document.getElementById('approveOrderBtn').addEventListener('click', () => {
                const orderId = document.getElementById('orderDetailsId').textContent;
                processOrderAction(orderId, 'approved', 'Order Confirmed', 'Your order has been approved by the supplier');
            });
            
            document.getElementById('markShippedBtn').addEventListener('click', () => {
                const orderId = document.getElementById('orderDetailsId').textContent;
                processOrderAction(orderId, 'in-transit', 'Shipped', 'Your order has been shipped and is on the way');
            });
            
            document.getElementById('markDeliveredBtn').addEventListener('click', () => {
                const orderId = document.getElementById('orderDetailsId').textContent;
                processOrderAction(orderId, 'delivered', 'Delivered', 'Your order has been delivered');
            });
            
            document.getElementById('confirmReceiptBtn').addEventListener('click', () => {
                const orderId = document.getElementById('orderDetailsId').textContent;
                processOrderAction(orderId, 'delivered', 'Delivered', 'Receipt confirmed by customer');
            });
            
            document.getElementById('cancelOrderBtn').addEventListener('click', () => {
                const orderId = document.getElementById('orderDetailsId').textContent;
                processOrderAction(orderId, 'cancelled', 'Cancelled', 'Order has been cancelled');
            });
            
            // Process order action
            function processOrderAction(orderId, newStatus, statusLabel, description) {
                const order = mockData.orders.find(o => o.id === orderId);
                
                if (!order) {
                    showToast('Order not found', 'error');
                    return;
                }
                
                // Update order status
                order.status = newStatus;
                
                // Add tracking event
                order.tracking.push({
                    date: new Date().toISOString(),
                    status: statusLabel,
                    description: description
                });
                
                // Add notification for the other party
                const notifUserType = mockData.currentUserType === 'farmer' ? 'supplier' : 'farmer';
                mockData.notifications.unshift({
                    id: `notif-${Math.floor(10000 + Math.random() * 90000)}`,
                    userType: notifUserType,
                    title: `Order ${statusLabel}`,
                    message: `Order #${orderId} has been ${newStatus.replace('-', ' ')}.`,
                    timestamp: new Date().toISOString(),
                    read: false,
                    orderId: orderId
                });
                
                // Add to activity feed
                mockData.activities.unshift({
                    id: `activity-${Math.floor(10000 + Math.random() * 90000)}`,
                    userType: 'both',
                    date: new Date().toISOString(),
                    activity: `Order #${orderId} has been ${newStatus.replace('-', ' ')}`,
                    status: newStatus === 'cancelled' ? 'error' : 'success'
                });
                
                // Close modal
                document.getElementById('orderDetailsModal').classList.add('hidden');
                
                // Show toast
                showToast(`Order status updated to ${getStatusLabel(newStatus)}`, 'success');
                
                // Reload relevant views
                if (document.getElementById('dashboard-view').classList.contains('hidden')) {
                    if (document.getElementById('orders-view').classList.contains('hidden')) {
                        loadRecentDeliveries();
                        loadOrderTracking(orderId);
                    } else {
                        loadOrders();
                    }
                } else {
                    loadDashboard();
                }
            }
        }
        
        // Initialize the application
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
